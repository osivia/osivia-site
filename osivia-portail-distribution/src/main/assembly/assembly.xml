<assembly xmlns="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.2"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.2 http://maven.apache.org/xsd/assembly-1.1.2.xsd">
  <id>bin</id>
  <formats>
    <format>zip</format>
  </formats>
  <includeBaseDirectory>false</includeBaseDirectory>

  <dependencySets>

    <dependencySet>
      <outputDirectory>/portal-${dest-env}-${project.version}/custom/deploy</outputDirectory>
      <unpack>false</unpack>
      <scope>runtime</scope>
	<includes>
		<include>toutatice-portail.demo:toutatice-portail-demo-cms-nuxeo-web:war:${project.version}</include>
        	<include>toutatice-portail.demo:toutatice-portail-demo-test-portlet:war:${project.version}</include>
		<include>toutatice-portail.demo:toutatice-portail-demo-user-module:war:${project.version}</include>
        	<include>toutatice-portail.demo:toutatice-portail-demo-charte:war:${project.version}</include>
		<include>toutatice-portail.demo:toutatice-portail-demo-spring3-portlet:war:${project.version}</include>
		<include>toutatice-services.faq:toutatice-faq-portail:war:${toutatice.faq.version}</include>
		<include>toutatice-services.rss:toutatice-rss-portail:war:${toutatice.rss.version}</include>
		<include>toutatice-services.dashboard.ecm:toutatice-dashboard-ecm-portail:war:${toutatice.dashboard.ecm.version}</include>
       	</includes>
    </dependencySet>
   </dependencySets>

    <fileSets>
	<!-- socle -->

	<fileSet>
	  <outputDirectory>/portal-${dest-env}-${project.version}</outputDirectory>
          <directory>target/toutatice-distribution</directory>
 	    <includes>
		<include>jboss-as/**</include>
		<include>custom/**</include>
   	   </includes>
	  <excludes>

		<!-- exclude distribution environment specific files -->

		<exclude>custom/params/environnement_portail.properties.*</exclude>
		<exclude>jboss-as/server/production/run.conf.*</exclude>
		<exclude>jboss-as/server/production/conf/jboss-log4j.*</exclude>
     	  </excludes>
      </fileSet>

	<fileSet>
	  <outputDirectory>/portal-${dest-env}-${project.version}</outputDirectory>
          <directory>src/main/resources</directory>
	  <excludes>
		<exclude>custom/params/environnement_portail.properties.*</exclude>
		<exclude>/jboss-as/server/production/run.conf.*</exclude>
     	  </excludes>
        </fileSet>


      </fileSets>

	<!-- copy local environment specific files -->

	<files>
  		<file>
                        <source>src/main/resources/custom/params/environnement_portail.properties.${dest-env}</source>
                        <outputDirectory>/portal-${dest-env}-${project.version}/custom/params</outputDirectory>
                        <destName>environnement_portail.properties</destName>
                </file>
		<file>
			<source>src/main/resources/jboss-as/server/production/run.conf.${dest-env}</source>
			<outputDirectory>/portal-${dest-env}-${project.version}/jboss-as/server/production</outputDirectory>
			<destName>run.conf</destName>
		</file>
		<file>
                        <source>target/toutatice-distribution/jboss-as/server/production/conf/jboss-log4j.xml.${src-env}</source>
                        <outputDirectory>/portal-${dest-env}-${project.version}/jboss-as/server/production/conf</outputDirectory>
                        <destName>jboss-log4j.xml</destName>
                </file>


         </files>



</assembly>
